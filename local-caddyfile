:8080 {
	encode gzip
	handle_path /api/* {
		reverse_proxy 0.0.0.0:3000
	}

	handle {
		root * build/
		try_files {path} /index.html
		file_server	
	}

	log {
		output file caddy.log {
			roll_size 1gb
            roll_keep 2
            roll_keep_for 720h
		}
		format json {
            time_format wall
        }
	}

}



:3000 {
	reverse_proxy {$API_URI}
	log {
		output file caddy.log {
			roll_size 1gb
            roll_keep 2
            roll_keep_for 720h
		}
		format json {
            time_format wall
        }
	}
}